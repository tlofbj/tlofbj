<!-- UPDATED Jan 13 5:24 PM -->

<!DOCTYPE html>
<html>
<head>
  <title>Happy Birthday Fireworks</title>
    <style>

      body {
        margin: 0;
        overflow: hidden;
        background-color: black;
      }

      button {
        position: fixed;
        bottom: 10%;
        left: 50%;
        width: 90%;
        transform: translate(-50%, 50%);
        background-color: #ffc400;
        border-width: 10px;
        border-color: white;
        padding: 15px 30px;
        font-size: 20px;
        cursor: pointer;
        font-family: kaiti-sc;
      }
    </style>
  </head>
<body>
  <button>button</button>
  <canvas id="canvas"></canvas>
<script>
  const canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  const button = document.querySelector("button");
  button.addEventListener("click", createRockets);
  
  function random(x, d){
    return Math.floor(Math.random() * x * 10**d)/(10**d)
  }

  setInterval(function(){Update()},10);
  function Update(){
    //ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear canvas
    ctx.fillStyle = "hsla(245, 100%, 20%, 0.05)"
    ctx.fillRect(0, 0, canvas.width, canvas.height);
  }

  function animateParticle(particle) {

    ctx.beginPath();
    ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
    ctx.fillStyle = `hsla(${particle.hue}, 100%, 50%, ${particle.opacity})`;
    ctx.fill();
    ctx.closePath();

    particle.x += particle.vx;
    particle.y += particle.vy;
    particle.vy += particle.gravity;

    if (particle.type == "flower") {
      particle.opacity -= 0.01;
    }

    if (particle.vy > particle.deathHeight) {
      if (particle.type == "first-time"){
        createFlowers(particle.x, particle.y, particle.hue);
      } 
    } else {
      requestAnimationFrame(() => animateParticle(particle));
    }
  }

  function createRockets() {
    const numParticles = random(10, 0);
    for (let i = 0; i < numParticles; i++) {
      const particle = {
        x: button.offsetLeft,
        y: button.offsetTop + 50,
        vx: random(4, 3) - 2,
        vy: -random(8, 3) - 4,
        opacity: 0.8,
        hue: random(360, 0),
        type: "first-time",
        gravity: 0.1,
        deathHeight: 3,
        size: 5
      };
      animateParticle(particle);
    }
  }

  function createFlowers(x, y, hue) {
    const numParticles = random(50, 0);
    for (let i = 0; i < numParticles; i++) {
      const particle = {
        x: x,
        y: y,
        vx: random(6, 3) - 3,
        vy: -random(6, 3) + 2,
        hue: hue,
        opacity: random(1.5, 1),
        type: "flower",
        gravity: 0.1,
        deathHeight: 10,
        size: random(6, 1)
      };
      animateParticle(particle);
    }
  }
</script>
</body>
</html>
